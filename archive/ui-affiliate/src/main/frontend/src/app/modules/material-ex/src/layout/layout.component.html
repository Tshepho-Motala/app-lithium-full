<div fxLayout="column" fxLayoutAlign="start stretch" style="height: 100vh">

  <md-toolbar #primaryToolbar [fxHide]="!hasPrimaryToolbarContent" fxHide.lt-md color="primary" class="mat-elevation-z4" style="z-index: 2">
    <div #primaryToolbarStart fxLayout="row"></div>
    <span fxFlex></span>
    <div #primaryToolbarEnd fxLayout="row"></div>
    <button *ngIf="hasRightnavContent" fxHide.gt-md md-icon-button (click)="rightnav.toggle()"><md-icon>menu</md-icon></button>
  </md-toolbar>

  <md-sidenav-container fxFlex fxLayout="column">

    <md-sidenav #sidenav [fxHide]="!hasSidenavContent && media.isActive('gt-sm')" align="start" style="z-index: 100" class="mat-elevation-z2"
        [mode]="media.isActive('gt-sm')? 'side': 'over'"
        [opened]="media.isActive('gt-sm')" (click)="sidenavClose($event)"> 
  
      <md-toolbar #primaryToolbarMobile [fxHide]="!hasPrimaryToolbarContent" fxHide.gt-sm color="primary">
        <div #primaryToolbarStartMobile></div>
        <md-toolbar-row>
          <div #primaryToolbarEndMobile></div>
        </md-toolbar-row>
      </md-toolbar>

      <div #sidenavContent></div>
    </md-sidenav>

    <md-sidenav #rightnav [fxHide]="!hasRightnavContent" align="end" style="z-index: 100" class="mat-elevation-z2"
        [mode]="media.isActive('gt-md')? 'side': 'over'"
        [opened]="media.isActive('gt-md')"> 
      <div #rightnavContent></div>
    </md-sidenav>

    <div fxLayout="column" fxFlex>

      <md-toolbar id="secondaryToolbar" #secondaryToolbar [fxHide]="!hasSecondaryToolbarContent" [class]="media.isActive('gt-sm')? 'mtex-bc-grey-200': 'mtex-bc-primary-700 mat-elevation-z2 mtex-tc-white'" style="z-index: 2">
        <div [@rotateInAnimation]="true" *ngIf="(hasSidenavContent && media.isActive('lt-md')) || hasNestedPages" style="position: relative">
          <button style="visibility: hidden" [@rotateInAnimation]="true" md-icon-button ><md-icon>menu</md-icon></button>
          <button style="position: absolute" [@rotateOutAnimation]="true" *ngIf="hasSidenavContent && !hasNestedPages" fxHide.gt-sm md-icon-button (click)="sidenav.toggle()"><md-icon>menu</md-icon></button>
          <button style="position: absolute" [@rotateInAnimation]="true" *ngIf="hasNestedPages" md-icon-button (click)="back();"><md-icon>arrow_back</md-icon></button>
        </div>
        <div #secondaryToolbarStart></div>
        <span fxFlex></span>
        <div #secondaryToolbarEnd></div>
        
      </md-toolbar>

      <div fxFlex style="position: relative">
          <ng-content></ng-content>
      </div>

    </div>

  </md-sidenav-container>

</div>
