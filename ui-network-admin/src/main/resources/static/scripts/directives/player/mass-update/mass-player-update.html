<div class="row v-reset-row ">
    <div class="col-xs-12" ng-if="!controller.start && (controller.uploading || controller.checking || controller.waitForProcessingStart || controller.done || controller.failed)">
        <div class="progress progress-striped active" style="margin-top: 10px">
            <div class="progress-bar {{controller.done ? 'bg-green' : controller.failed ? 'bg-red' : ''}}" role="progressbar" aria-valuenow="100"
                 aria-valuemin="0" aria-valuemax="100" style="width:100%">
                <span ng-if="controller.uploading">{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.PROGRESS_BAR.UPLOADING_LABEL' | translate}}</span>
                <span ng-if="controller.waitForProcessingStart">{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.PROGRESS_BAR.PROCESSING_LABEL' | translate}}</span>
                <span ng-if="controller.done">{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.PROGRESS_BAR.ACTIONS_SUCCESSFULLY_APPLIED' | translate}}</span>
                <span ng-if="controller.failed">{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.PROGRESS_BAR.NO_VALID_PLAYERS' | translate}}</span>
                <span ng-if="controller.checking">{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.PROGRESS_BAR.VALIDATING' | translate}} {{ controller.model.progress | number:0 }}%</span>
            </div>
        </div>
    </div>
    <div class="modal-body" id="modal-body">
        <div class="row v-reset-row bottom-space-10">
            <buttonbar>
                <button-back ng-if="controller.model.view === 'action'" ng-click="controller.back()"></button-back>
                <button-add ng-if="controller.model.view === 'history'" ng-click="controller.addAction()"></button-add>
                <button-refresh ng-if="controller.model.view === 'history'" class="pull-right" ng-click="controller.refreshHistoryTable()"></button-refresh>
            </buttonbar>
        </div>
        <div ng-if="controller.model.view === 'history'" class="well-clear">
            <dt class="table table-sm table-responsive" table="controller.userMassActionHistoryTable"/>
        </div>
        <div ng-if="controller.model.view === 'action'" class="container-fluid well-clear">
            <div class="col-xs-12" ng-if="!controller.start && !controller.uploading && (controller.checked || controller.processing || controller.done || controller.failed) && controller.model.action.id != -1">
                <div class="box-body table-responsive">
                    <dt class="table table-sm table-responsive" table="controller.checkedTable"/>
                </div>
                <div>
                    <div class="col-xs-12">
                        <label class="text-green">{{controller.model.uploadSummary.existingPlayers}}&nbsp;{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.SUMMARY.EXISTING_PLAYERS' | translate}}</label>
                    </div>
                    <div class="col-xs-12">
                        <label class="text-red">{{controller.model.uploadSummary.undefinedPlayers}}&nbsp;{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.SUMMARY.UNDEFINED_PLAYERS' | translate}}</label>
                    </div>
                    <div class="col-xs-12">
                        <label class="text-orange">{{controller.model.uploadSummary.duplicatePlayers}}&nbsp;{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.SUMMARY.DUPLICATED_PLAYERS' | translate}}</label>
                    </div>
                </div>
                <br>
            </div>
            <div class="col-xs-12">
                <div class="col-xs-2" style="padding: 0px; padding-top: 20px" ng-if="controller.start || controller.uploading || controller.checked || !controller.done">
                    <input type="file" id="files" class="hidden" ngf-select="controller.selectFile($file)"/>
                    <label for="files" class="btn btn-default">{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.FIELDS.CHOOSE_FILE.LABEL' | translate}}</label>
                </div>
                <div class="col-xs-6" style="padding: 0px;">
                    <div class="row-fluid">
                        <label class="text-blue" ng-if="controller.model.fileName" style="display: inline; margin-top: 10px">{{controller.model.fileName}}</label>
                        <br>
                        <label class="pull-right text-blue" ng-if="controller.model.fileSize" style="margin-top: -20px">{{controller.model.fileSize}}</label>
                    </div>
                    <div class="row-fluid">
                        <div ng-if="controller.uploading || controller.checked || controller.processing" class="progress" style="margin-top: 10px">
                            <div class="progress-bar" role="progressbar" aria-valuenow="{{controller.model.progress}}"
                                 aria-valuemin="0" aria-valuemax="100" style="width:{{controller.model.progress}}%">
                                <span>{{!controller.model.progress ? 0 : controller.model.progress | number : 2}}%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xs-12" style="padding: 0px;">
                <label style="margin: 15px;font-weight: 100;font-size: smaller;padding-bottom: 10px;">{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.TOOLTIP.LABEL' | translate}}</label>
            </div>
            <div class="col-xs-12" style="padding-bottom: 10px;">
                <buttonbar>
                    <button-update ng-if="controller.processBtn && controller.model.view === 'action'" ng-disabled="controller.disableSubmit()" ng-click="controller.submit()"></button-update>
                    <button-collapse ng-if="controller.model.view === 'action'" class="pull-right" ng-click="controller.collapse()"></button-collapse>
                    <button-expand ng-if="controller.model.view === 'action'" class="pull-right" ng-click="controller.expand()"></button-expand>
                </buttonbar>
            </div>
            <div class="col-xs-12">
                <form name="controller.form">
                    <span ng-show="controller.form.$error.required" hidden>{{'GLOBAL.VALIDATION.REQUIRED' | translate}}</span>
                    <uib-accordion close-others="false">
                       <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.ACTIONS.CHANGE_STATUS.LABEL' | translate}}" is-open="controller.model.options.changeStatus" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_REGULAR" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <formly-form model="controller.model" fields="controller.fields.status" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>
                        <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.ACTIONS.CHANGE_VERIFICATION_STATUS.LABEL' | translate}}" is-open="controller.model.options.changeVerificationStatus" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_REGULAR" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <p ng-if="controller.model.verificationStatus == 2" class="text-danger">{{'UI_NETWORK_ADMIN.USER.ALERT.MANUALLY_VERIFIED' | translate}}</p>
                                    <p ng-if="controller.model.verificationStatus == 3" class="text-danger">{{'UI_NETWORK_ADMIN.USER.ALERT.EXTERNALLY_VERIFIED' | translate}}</p>
                                    <formly-form model="controller.model" fields="controller.fields.verificationStatus" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>
                        <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.BIOMETRICS_STATUS.MASS_UPDATE.ACTIONS.CHANGE_BIOMETRICS_STATUS.LABEL' | translate}}" is-open="controller.model.options.changeBiometricsStatus" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_REGULAR" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <formly-form model="controller.model" fields="controller.fields.biometricsStatus" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>
                        <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.ACTIONS.PROCESS_ACCESS_RULE.LABEL' | translate}}" is-open="controller.model.options.processAccessRule" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_REGULAR" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <formly-form model="controller.model" fields="controller.fields.accessRule" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>
                        <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.ACTIONS.MARK_AS_TEST_PLAYER.LABEL' | translate}}" is-open="controller.model.options.masAsTestPlayer" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_REGULAR" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <formly-form model="controller.model" fields="controller.fields.testPlayer" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>
                        <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.ACTIONS.UPDATE_PLAYER_TAGS.LABEL' | translate}}" is-open="controller.model.options.playerTags" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_REGULAR" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <formly-form model="controller.model" fields="controller.fields.tagnames" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>
                        <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.ACTIONS.ADD_NOTE.LABEL' | translate}}" is-open="controller.model.options.addNote" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_REGULAR" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <formly-form model="controller.model" fields="controller.fields.note" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>

                        <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.ACTIONS.BALANCE_ADJUST.LABEL' | translate}}" is-open="controller.model.options.balanceAdjust" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_FINANCIAL" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <formly-form model="controller.model" fields="controller.fields.adjust" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>

                        <div uib-accordion-group class="panel-default" heading="{{'UI_NETWORK_ADMIN.PLAYERS.MASS_UPDATE.ACTIONS.PLAYER_RESTRICTIONS.LABEL' | translate}}" is-open="controller.model.options.playerRestrictions" is-disabled="false" lit-if-permission="MASS_PLAYER_UPDATE_REGULAR" lit-permission-domain="{{data.domainName}}">
                            <div class="row v-reset-row ">
                                <div class="col-xs-12">
                                    <formly-form model="controller.model" fields="controller.getRestrictionFieldsOrdered()" options="controller.options" form="controller.form">
                                    </formly-form>
                                </div>
                            </div>
                        </div>
                    </uib-accordion>
                </form>
            </div>
            <div class="col-xs-12" style="padding-bottom: 10px;">
                <button  class="btn btn-primary"
                         ng-click="controller.submit()"
                         ng-if="controller.processBtn && controller.model.view === 'action'"
                         ng-disabled="controller.disableSubmit()">
                    <i class="fab fa fa-floppy-o" aria-hidden="true"></i>
                    Save
                </button>
                <buttonbar>
                    <button-update ng-if="controller.processBtn && controller.model.view === 'action'" ng-disabled="controller.disableSubmit()" ng-click="controller.submit()"></button-update>
                    <button-collapse ng-if="controller.model.view === 'action'" class="pull-right" ng-click="controller.collapse()"></button-collapse>
                    <button-expand ng-if="controller.model.view === 'action'" class="pull-right" ng-click="controller.expand()"></button-expand>
                </buttonbar>
            </div>
        </div>
    </div>
</div>
